<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ipaylinks.cmp.css.dal.mapper.TradeAccountReportMapper">
  <resultMap id="BaseResultMap" type="com.ipaylinks.cmp.css.dal.model.TradeAccountReport">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Tue Aug 21 17:45:02 CST 2018.
    -->
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="MERCHANT_ID" jdbcType="VARCHAR" property="merchantId" />
    <result column="MERCHANT_NAME" jdbcType="VARCHAR" property="merchantName" />
    <result column="TRADE_MONTH" jdbcType="DECIMAL" property="tradeMonth" />
    <result column="PAY_METHOD" jdbcType="VARCHAR" property="payMethod" />
    <result column="TRANS_AMOUNT" jdbcType="DECIMAL" property="transAmount" />
    <result column="TRANS_COUNT" jdbcType="DECIMAL" property="transCount" />
    <result column="REFUND_COUNT" jdbcType="DECIMAL" property="refundCount" />
    <result column="REFUND_AMOUNT" jdbcType="DECIMAL" property="refundAmount" />
    <result column="REFUSE_COUNT" jdbcType="DECIMAL" property="refuseCount" />
    <result column="REFUSE_AMOUNT" jdbcType="DECIMAL" property="refuseAmount" />
    <result column="TRANS_FEE" jdbcType="DECIMAL" property="transFee" />
    <result column="FIXED_CHARDE_FEE" jdbcType="DECIMAL" property="fixedChardeFee" />
    <result column="REFUSE_RATIO" jdbcType="DECIMAL" property="refuseRatio" />
    <result column="GMT_CREATE_TIME" jdbcType="TIMESTAMP" property="gmtCreateTime" />
    <result column="GMT_UPDATE_TIME" jdbcType="TIMESTAMP" property="gmtUpdateTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Tue Aug 21 17:45:02 CST 2018.
    -->
    ID, MERCHANT_ID, MERCHANT_NAME, TRADE_MONTH, PAY_METHOD, TRANS_AMOUNT, TRANS_COUNT, 
    REFUND_COUNT, REFUND_AMOUNT, REFUSE_COUNT, REFUSE_AMOUNT, TRANS_FEE, FIXED_CHARDE_FEE, 
    REFUSE_RATIO, GMT_CREATE_TIME, GMT_UPDATE_TIME
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Tue Aug 21 17:45:02 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from T_TRADE_ACCOUNT_REPORT
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Tue Aug 21 17:45:02 CST 2018.
    -->
    delete from T_TRADE_ACCOUNT_REPORT
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.ipaylinks.cmp.css.dal.model.TradeAccountReport">
    <selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE">
      SELECT TO_CHAR(SYSDATE, 'yymmddhh24miss')||SEQ_CYCLE_FOR_ID.nextval FROM DUAL
    </selectKey>
    insert into T_TRADE_ACCOUNT_REPORT (ID, MERCHANT_ID, MERCHANT_NAME, 
      TRADE_MONTH, PAY_METHOD, TRANS_AMOUNT, 
      TRANS_COUNT, REFUND_COUNT, REFUND_AMOUNT, 
      REFUSE_COUNT, REFUSE_AMOUNT, TRANS_FEE, 
      FIXED_CHARDE_FEE, REFUSE_RATIO, GMT_CREATE_TIME, 
      GMT_UPDATE_TIME)
    values (#{id,jdbcType=VARCHAR}, #{merchantId,jdbcType=VARCHAR}, #{merchantName,jdbcType=VARCHAR}, 
      #{tradeMonth,jdbcType=DECIMAL}, #{payMethod,jdbcType=VARCHAR}, #{transAmount,jdbcType=DECIMAL}, 
      #{transCount,jdbcType=DECIMAL}, #{refundCount,jdbcType=DECIMAL}, #{refundAmount,jdbcType=DECIMAL}, 
      #{refuseCount,jdbcType=DECIMAL}, #{refuseAmount,jdbcType=DECIMAL}, #{transFee,jdbcType=DECIMAL}, 
      #{fixedChardeFee,jdbcType=DECIMAL}, #{refuseRatio,jdbcType=DECIMAL}, #{gmtCreateTime,jdbcType=TIMESTAMP}, 
      #{gmtUpdateTime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.ipaylinks.cmp.css.dal.model.TradeAccountReport">
    <selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE">
      SELECT TO_CHAR(SYSDATE, 'yymmddhh24miss')||SEQ_CYCLE_FOR_ID.nextval FROM DUAL
    </selectKey>
    insert into T_TRADE_ACCOUNT_REPORT
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="merchantId != null">
        MERCHANT_ID,
      </if>
      <if test="merchantName != null">
        MERCHANT_NAME,
      </if>
      <if test="tradeMonth != null">
        TRADE_MONTH,
      </if>
      <if test="payMethod != null">
        PAY_METHOD,
      </if>
      <if test="transAmount != null">
        TRANS_AMOUNT,
      </if>
      <if test="transCount != null">
        TRANS_COUNT,
      </if>
      <if test="refundCount != null">
        REFUND_COUNT,
      </if>
      <if test="refundAmount != null">
        REFUND_AMOUNT,
      </if>
      <if test="refuseCount != null">
        REFUSE_COUNT,
      </if>
      <if test="refuseAmount != null">
        REFUSE_AMOUNT,
      </if>
      <if test="transFee != null">
        TRANS_FEE,
      </if>
      <if test="fixedChardeFee != null">
        FIXED_CHARDE_FEE,
      </if>
      <if test="refuseRatio != null">
        REFUSE_RATIO,
      </if>
      <if test="gmtCreateTime != null">
        GMT_CREATE_TIME,
      </if>
      <if test="gmtUpdateTime != null">
        GMT_UPDATE_TIME,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="merchantId != null">
        #{merchantId,jdbcType=VARCHAR},
      </if>
      <if test="merchantName != null">
        #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="tradeMonth != null">
        #{tradeMonth,jdbcType=DECIMAL},
      </if>
      <if test="payMethod != null">
        #{payMethod,jdbcType=VARCHAR},
      </if>
      <if test="transAmount != null">
        #{transAmount,jdbcType=DECIMAL},
      </if>
      <if test="transCount != null">
        #{transCount,jdbcType=DECIMAL},
      </if>
      <if test="refundCount != null">
        #{refundCount,jdbcType=DECIMAL},
      </if>
      <if test="refundAmount != null">
        #{refundAmount,jdbcType=DECIMAL},
      </if>
      <if test="refuseCount != null">
        #{refuseCount,jdbcType=DECIMAL},
      </if>
      <if test="refuseAmount != null">
        #{refuseAmount,jdbcType=DECIMAL},
      </if>
      <if test="transFee != null">
        #{transFee,jdbcType=DECIMAL},
      </if>
      <if test="fixedChardeFee != null">
        #{fixedChardeFee,jdbcType=DECIMAL},
      </if>
      <if test="refuseRatio != null">
        #{refuseRatio,jdbcType=DECIMAL},
      </if>
      <if test="gmtCreateTime != null">
        #{gmtCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtUpdateTime != null">
        #{gmtUpdateTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.ipaylinks.cmp.css.dal.model.TradeAccountReport">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Tue Aug 21 17:45:02 CST 2018.
    -->
    update T_TRADE_ACCOUNT_REPORT
    <set>
      <if test="merchantId != null">
        MERCHANT_ID = #{merchantId,jdbcType=VARCHAR},
      </if>
      <if test="merchantName != null">
        MERCHANT_NAME = #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="tradeMonth != null">
        TRADE_MONTH = #{tradeMonth,jdbcType=DECIMAL},
      </if>
      <if test="payMethod != null">
        PAY_METHOD = #{payMethod,jdbcType=VARCHAR},
      </if>
      <if test="transAmount != null">
        TRANS_AMOUNT = #{transAmount,jdbcType=DECIMAL},
      </if>
      <if test="transCount != null">
        TRANS_COUNT = #{transCount,jdbcType=DECIMAL},
      </if>
      <if test="refundCount != null">
        REFUND_COUNT = #{refundCount,jdbcType=DECIMAL},
      </if>
      <if test="refundAmount != null">
        REFUND_AMOUNT = #{refundAmount,jdbcType=DECIMAL},
      </if>
      <if test="refuseCount != null">
        REFUSE_COUNT = #{refuseCount,jdbcType=DECIMAL},
      </if>
      <if test="refuseAmount != null">
        REFUSE_AMOUNT = #{refuseAmount,jdbcType=DECIMAL},
      </if>
      <if test="transFee != null">
        TRANS_FEE = #{transFee,jdbcType=DECIMAL},
      </if>
      <if test="fixedChardeFee != null">
        FIXED_CHARDE_FEE = #{fixedChardeFee,jdbcType=DECIMAL},
      </if>
      <if test="refuseRatio != null">
        REFUSE_RATIO = #{refuseRatio,jdbcType=DECIMAL},
      </if>
      <if test="gmtCreateTime != null">
        GMT_CREATE_TIME = #{gmtCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtUpdateTime != null">
        GMT_UPDATE_TIME = #{gmtUpdateTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ipaylinks.cmp.css.dal.model.TradeAccountReport">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Tue Aug 21 17:45:02 CST 2018.
    -->
    update T_TRADE_ACCOUNT_REPORT
    set MERCHANT_ID = #{merchantId,jdbcType=VARCHAR},
      MERCHANT_NAME = #{merchantName,jdbcType=VARCHAR},
      TRADE_MONTH = #{tradeMonth,jdbcType=DECIMAL},
      PAY_METHOD = #{payMethod,jdbcType=VARCHAR},
      TRANS_AMOUNT = #{transAmount,jdbcType=DECIMAL},
      TRANS_COUNT = #{transCount,jdbcType=DECIMAL},
      REFUND_COUNT = #{refundCount,jdbcType=DECIMAL},
      REFUND_AMOUNT = #{refundAmount,jdbcType=DECIMAL},
      REFUSE_COUNT = #{refuseCount,jdbcType=DECIMAL},
      REFUSE_AMOUNT = #{refuseAmount,jdbcType=DECIMAL},
      TRANS_FEE = #{transFee,jdbcType=DECIMAL},
      FIXED_CHARDE_FEE = #{fixedChardeFee,jdbcType=DECIMAL},
      REFUSE_RATIO = #{refuseRatio,jdbcType=DECIMAL},
      GMT_CREATE_TIME = #{gmtCreateTime,jdbcType=TIMESTAMP},
      GMT_UPDATE_TIME = #{gmtUpdateTime,jdbcType=TIMESTAMP}
    where ID = #{id,jdbcType=VARCHAR}
  </update>

  <insert id="batchCreate" parameterType="com.ipaylinks.cmp.css.dal.model.TradeAccountReport">
    insert into T_TRADE_ACCOUNT_REPORT (ID, MERCHANT_ID, MERCHANT_NAME,
    TRADE_MONTH, PAY_METHOD, TRANS_AMOUNT,
    TRANS_COUNT, REFUND_COUNT, REFUND_AMOUNT,
    REFUSE_COUNT, REFUSE_AMOUNT, TRANS_FEE,
    FIXED_CHARDE_FEE, REFUSE_RATIO)
    SELECT TO_CHAR(SYSDATE, 'yymmddhh24miss')||SEQ_CYCLE_FOR_ID.nextval, A.*
    FROM (
    <foreach collection="list" item="item" index="index" open="" close="" separator="union all">
      select #{item.merchantId,jdbcType=VARCHAR}, #{item.merchantName,jdbcType=VARCHAR},
      #{item.tradeMonth,jdbcType=DECIMAL}, #{item.payMethod,jdbcType=VARCHAR}, #{item.transAmount,jdbcType=DECIMAL},
      #{item.transCount,jdbcType=DECIMAL}, #{item.refundCount,jdbcType=DECIMAL}, #{item.refundAmount,jdbcType=DECIMAL},
      #{item.refuseCount,jdbcType=DECIMAL}, #{item.refuseAmount,jdbcType=DECIMAL}, #{item.transFee,jdbcType=DECIMAL},
      #{item.fixedChardeFee,jdbcType=DECIMAL}, #{item.refuseRatio,jdbcType=DECIMAL}
      from dual
    </foreach>
    ) A
  </insert>

  <delete id="deleteLastMonth">
    delete from T_TRADE_ACCOUNT_REPORT where TRADE_MONTH = to_number(to_char(trunc(add_months(sysdate, -1), 'month'), 'yyyyMM'))
  </delete>

  <select id="selectLastMonthByMerchantIdAndPayMethod" parameterType="com.ipaylinks.cmp.css.dal.model.TradeAccountReport" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from T_TRADE_ACCOUNT_REPORT
    where MERCHANT_ID = #{merchantId,jdbcType=VARCHAR}
      and PAY_METHOD = #{payMethod,jdbcType=VARCHAR}
      and TRADE_MONTH = to_number(to_char(trunc(add_months(sysdate, -1), 'month'), 'yyyyMM'))
  </select>

</mapper>
