<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ipaylinks.cmp.css.dal.mapper.MertSettlementSummaryMapper">
  <resultMap id="BaseResultMap" type="com.ipaylinks.cmp.css.dal.model.MertSettlementSummary">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="MERCHANT_ID" jdbcType="VARCHAR" property="merchantId" />
    <result column="SUMMARY_DATE" jdbcType="VARCHAR" property="summaryDate" />
    <result column="SUMMARY_CURRENCY" jdbcType="VARCHAR" property="summaryCurrency" />
    <result column="SUMMARY_AMOUNT" jdbcType="DECIMAL" property="summaryAmount" />
    <result column="BEGIN_DATE" jdbcType="VARCHAR" property="beginDate" />
    <result column="END_DATE" jdbcType="VARCHAR" property="endDate" />
    <result column="AUTO_WITHDRAW_FLAG" jdbcType="VARCHAR" property="autoWithdrawFlag" />
    <result column="WITHDRAW_STATUS" jdbcType="VARCHAR" property="withdrawStatus" />
    <result column="WITHDRAW_ID" jdbcType="VARCHAR" property="withdrawId" />
    <result column="WITHDRAW_REQUEST_TIME" jdbcType="TIMESTAMP" property="withdrawRequestTime" />
    <result column="WITHDRAW_COMPLETE_TIME" jdbcType="TIMESTAMP" property="withdrawCompleteTime" />
    <result column="GMT_CREATE_TIME" jdbcType="TIMESTAMP" property="gmtCreateTime" />
    <result column="GMT_UPDATE_TIME" jdbcType="TIMESTAMP" property="gmtUpdateTime" />
    <result column="MERCHANT_NAME" jdbcType="VARCHAR" property="merchantName" />
    <result column="SUMMARY_ORDER_ID" jdbcType="VARCHAR" property="summaryOrderId" />
    <result column="DEAL_STATUS" jdbcType="VARCHAR" property="dealStatus" />
    
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    ID, MERCHANT_ID, SUMMARY_DATE, SUMMARY_CURRENCY, SUMMARY_AMOUNT, BEGIN_DATE, END_DATE, 
    AUTO_WITHDRAW_FLAG, WITHDRAW_STATUS, WITHDRAW_ID, WITHDRAW_REQUEST_TIME, WITHDRAW_COMPLETE_TIME, 
    GMT_CREATE_TIME, GMT_UPDATE_TIME,MERCHANT_NAME,SUMMARY_ORDER_ID,DEAL_STATUS
  </sql>
  
  <sql id="Base_Header_Column_List">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    MERCHANT_ID, SUMMARY_DATE,MERCHANT_NAME,SUMMARY_AMOUNT
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from T_MERT_SETTLEMENT_SUMMARY
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    delete from T_MERT_SETTLEMENT_SUMMARY
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.ipaylinks.cmp.css.dal.model.MertSettlementSummary">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    insert into T_MERT_SETTLEMENT_SUMMARY (ID, MERCHANT_ID, SUMMARY_DATE, 
      SUMMARY_CURRENCY, SUMMARY_AMOUNT, BEGIN_DATE, 
      END_DATE, AUTO_WITHDRAW_FLAG, WITHDRAW_STATUS, 
      WITHDRAW_ID, WITHDRAW_REQUEST_TIME, WITHDRAW_COMPLETE_TIME, 
      GMT_CREATE_TIME, GMT_UPDATE_TIME,MERCHANT_NAME,SUMMARY_ORDER_ID,DEAL_STATUS)
    values (#{id,jdbcType=VARCHAR}, #{merchantId,jdbcType=VARCHAR}, #{summaryDate,jdbcType=VARCHAR}, 
      #{summaryCurrency,jdbcType=VARCHAR}, #{summaryAmount,jdbcType=DECIMAL}, #{beginDate,jdbcType=VARCHAR}, 
      #{endDate,jdbcType=VARCHAR}, #{autoWithdrawFlag,jdbcType=VARCHAR}, #{withdrawStatus,jdbcType=VARCHAR}, 
      #{withdrawId,jdbcType=VARCHAR}, #{withdrawRequestTime,jdbcType=TIMESTAMP}, #{withdrawCompleteTime,jdbcType=TIMESTAMP}, 
      #{gmtCreateTime,jdbcType=TIMESTAMP}, #{gmtUpdateTime,jdbcType=TIMESTAMP},
      #{merchantName,jdbcType=VARCHAR},
      #{summaryOrderId,jdbcType=VARCHAR},#{dealStatus,jdbcType=VARCHAR}
      )
      
  </insert>
  <insert id="insertSelective" parameterType="com.ipaylinks.cmp.css.dal.model.MertSettlementSummary">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    <selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE">
      SELECT '113'||TO_CHAR(SYSDATE, 'yymmdd')||SEQ_CYCLE_FOR_ID.nextval FROM DUAL
    </selectKey>
    insert into T_MERT_SETTLEMENT_SUMMARY
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="merchantId != null">
        MERCHANT_ID,
      </if>
      <if test="summaryDate != null">
        SUMMARY_DATE,
      </if>
      <if test="summaryCurrency != null">
        SUMMARY_CURRENCY,
      </if>
      <if test="summaryAmount != null">
        SUMMARY_AMOUNT,
      </if>
      <if test="beginDate != null">
        BEGIN_DATE,
      </if>
      <if test="endDate != null">
        END_DATE,
      </if>
      <if test="autoWithdrawFlag != null">
        AUTO_WITHDRAW_FLAG,
      </if>
      <if test="withdrawStatus != null">
        WITHDRAW_STATUS,
      </if>
      <if test="withdrawId != null">
        WITHDRAW_ID,
      </if>
      <if test="withdrawRequestTime != null">
        WITHDRAW_REQUEST_TIME,
      </if>
      <if test="withdrawCompleteTime != null">
        WITHDRAW_COMPLETE_TIME,
      </if>
      <if test="gmtCreateTime != null">
        GMT_CREATE_TIME,
      </if>
      <if test="gmtUpdateTime != null">
        GMT_UPDATE_TIME,
      </if>
      <if test="merchantName != null">
        MERCHANT_NAME,
      </if>
       <if test="summaryOrderId != null">
        SUMMARY_ORDER_ID,
      </if>
      <if test="dealStatus != null">
        DEAL_STATUS,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="merchantId != null">
        #{merchantId,jdbcType=VARCHAR},
      </if>
      <if test="summaryDate != null">
        #{summaryDate,jdbcType=VARCHAR},
      </if>
      <if test="summaryCurrency != null">
        #{summaryCurrency,jdbcType=VARCHAR},
      </if>
      <if test="summaryAmount != null">
        #{summaryAmount,jdbcType=DECIMAL},
      </if>
      <if test="beginDate != null">
        #{beginDate,jdbcType=VARCHAR},
      </if>
      <if test="endDate != null">
        #{endDate,jdbcType=VARCHAR},
      </if>
      <if test="autoWithdrawFlag != null">
        #{autoWithdrawFlag,jdbcType=VARCHAR},
      </if>
      <if test="withdrawStatus != null">
        #{withdrawStatus,jdbcType=VARCHAR},
      </if>
      <if test="withdrawId != null">
        #{withdrawId,jdbcType=VARCHAR},
      </if>
      <if test="withdrawRequestTime != null">
        #{withdrawRequestTime,jdbcType=TIMESTAMP},
      </if>
      <if test="withdrawCompleteTime != null">
        #{withdrawCompleteTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtCreateTime != null">
        #{gmtCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtUpdateTime != null">
        #{gmtUpdateTime,jdbcType=TIMESTAMP},
      </if>
       <if test="merchantName != null">
        #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="summaryOrderId != null">
        #{summaryOrderId,jdbcType=VARCHAR},
      </if>
       <if test="dealStatus != null">
        #{dealStatus,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.ipaylinks.cmp.css.dal.model.MertSettlementSummary">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    update T_MERT_SETTLEMENT_SUMMARY
    <set>
      <if test="merchantId != null">
        MERCHANT_ID = #{merchantId,jdbcType=VARCHAR},
      </if>
      <if test="summaryDate != null">
        SUMMARY_DATE = #{summaryDate,jdbcType=VARCHAR},
      </if>
      <if test="summaryCurrency != null">
        SUMMARY_CURRENCY = #{summaryCurrency,jdbcType=VARCHAR},
      </if>
      <if test="summaryAmount != null">
        SUMMARY_AMOUNT = #{summaryAmount,jdbcType=DECIMAL},
      </if>
      <if test="beginDate != null">
        BEGIN_DATE = #{beginDate,jdbcType=VARCHAR},
      </if>
      <if test="endDate != null">
        END_DATE = #{endDate,jdbcType=VARCHAR},
      </if>
      <if test="autoWithdrawFlag != null">
        AUTO_WITHDRAW_FLAG = #{autoWithdrawFlag,jdbcType=VARCHAR},
      </if>
      <if test="withdrawStatus != null">
        WITHDRAW_STATUS = #{withdrawStatus,jdbcType=VARCHAR},
      </if>
      <if test="withdrawId != null">
        WITHDRAW_ID = #{withdrawId,jdbcType=VARCHAR},
      </if>
      <if test="withdrawRequestTime != null">
        WITHDRAW_REQUEST_TIME = #{withdrawRequestTime,jdbcType=TIMESTAMP},
      </if>
      <if test="withdrawCompleteTime != null">
        WITHDRAW_COMPLETE_TIME = #{withdrawCompleteTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtCreateTime != null">
        GMT_CREATE_TIME = #{gmtCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtUpdateTime != null">
        GMT_UPDATE_TIME = #{gmtUpdateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="merchantName != null">
        MERCHANT_NAME= #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="summaryOrderId != null">
        SUMMARY_ORDER_ID= #{summaryOrderId,jdbcType=VARCHAR},
      </if>
       <if test="dealStatus != null">
        DEAL_STATUS= #{dealStatus,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ipaylinks.cmp.css.dal.model.MertSettlementSummary">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Thu May 24 17:03:46 CST 2018.
    -->
    update T_MERT_SETTLEMENT_SUMMARY
    set MERCHANT_ID = #{merchantId,jdbcType=VARCHAR},
      SUMMARY_DATE = #{summaryDate,jdbcType=VARCHAR},
      SUMMARY_CURRENCY = #{summaryCurrency,jdbcType=VARCHAR},
      SUMMARY_AMOUNT = #{summaryAmount,jdbcType=DECIMAL},
      BEGIN_DATE = #{beginDate,jdbcType=VARCHAR},
      END_DATE = #{endDate,jdbcType=VARCHAR},
      AUTO_WITHDRAW_FLAG = #{autoWithdrawFlag,jdbcType=VARCHAR},
      WITHDRAW_STATUS = #{withdrawStatus,jdbcType=VARCHAR},
      WITHDRAW_ID = #{withdrawId,jdbcType=VARCHAR},
      WITHDRAW_REQUEST_TIME = #{withdrawRequestTime,jdbcType=TIMESTAMP},
      WITHDRAW_COMPLETE_TIME = #{withdrawCompleteTime,jdbcType=TIMESTAMP},
      GMT_CREATE_TIME = #{gmtCreateTime,jdbcType=TIMESTAMP},
      GMT_UPDATE_TIME = #{gmtUpdateTime,jdbcType=TIMESTAMP},
      MERCHANT_NAME= #{merchantName,jdbcType=VARCHAR},
      SUMMARY_ORDER_ID= #{summaryOrderId,jdbcType=VARCHAR},
      DEAL_STATUS= #{dealStatus,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=VARCHAR}
  </update>

  <select id="selectList" parameterType="com.ipaylinks.cmp.css.dal.model.MertSettlementSummary" resultMap="BaseResultMap">
    select <include refid="Base_Column_List" /> from t_mert_settlement_summary
    where 1 = 1 <include refid="queryConditionSql" />
    order by gmt_create_time desc
  </select>

  <sql id="queryConditionSql">
    <if test="merchantId != null and merchantId != ''"> and merchant_id = #{merchantId} </if>
    <if test="summaryOrderId != null and summaryOrderId != ''"> and summary_order_id = #{summaryOrderId} </if>
    <if test="summaryCurrency != null and summaryCurrency != ''"> and summary_currency = #{summaryCurrency} </if>
    <if test="autoWithdrawFlag != null and autoWithdrawFlag != ''"> and auto_withdraw_flag = #{autoWithdrawFlag} </if>
    <if test="beginDate != null and beginDate != ''"> and summary_date &gt;= #{beginDate} </if>
    <if test="endDate != null and endDate != ''"> and summary_date &lt;= #{endDate} </if>
  </sql>
  
  <select id="getSettleSummaryHeaderList" parameterType="java.lang.String"  resultMap="BaseResultMap">
      select 
        MERCHANT_ID,SUMMARY_DATE,MERCHANT_NAME
    	from T_MERT_SETTLEMENT_SUMMARY
   	  where 1 = 1 
   	  <if test="merchantId != null and merchantId != ''">
         and MERCHANT_ID = #{merchantId}
      </if>
      <if test="summaryDate != null and summaryDate!=''">
     	 AND SUMMARY_DATE <![CDATA[=]]>#{summaryDate}
   	  </if>
  </select>
  
    <!--
      @生成结算单汇总编号
    -->
  <select id="getSettleSummaryOrderId" resultType="java.lang.String">
    	SELECT '113'||TO_CHAR(SYSDATE, 'yymmdd')||SEQ_CYCLE_FOR_ID.nextval FROM DUAL
  </select>
  
  <select id="getSettleSummaryOrderList" parameterType="java.lang.String"  resultMap="BaseResultMap">
	   select sum(SUMMARY_AMOUNT) SUMMARY_AMOUNT,
         SUMMARY_CURRENCY,
         SUMMARY_ORDER_ID,
         SUMMARY_DATE,
         MERCHANT_NAME,
         MERCHANT_ID
    from T_MERT_SETTLEMENT_SUMMARY
   	 where 1 = 1 
   	 <if test="merchantId != null and merchantId != ''">
         and MERCHANT_ID = #{merchantId}
     </if>
     <if test="summaryDate != null and summaryDate!=''">
     	 AND SUMMARY_DATE <![CDATA[=]]>#{summaryDate}
   	 </if>
       GROUP BY MERCHANT_ID,
            SUMMARY_DATE,
            SUMMARY_CURRENCY,
            MERCHANT_NAME,
            SUMMARY_ORDER_ID
   		ORDER BY MERCHANT_ID desc
  </select>
  
  <select id="getMertSettlementSummaryList" parameterType="java.lang.String"  resultMap="BaseResultMap">
      select 
       <include refid="Base_Column_List" /> 
    	from T_MERT_SETTLEMENT_SUMMARY
   	  where 1 = 1 
         AND MERCHANT_ID = #{merchantId}
     	 AND DEAL_STATUS=#{dealStatus}
     	 AND SUMMARY_CURRENCY=#{summaryCurrency}
  </select>
  
</mapper>